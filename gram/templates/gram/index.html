{% extends 'gram/base.html'%}
{% load crispy_forms_tags %}
{% load bootstrap5 %}
{% load static%}


{% block content%}



<div class="container">

    <!-- Button trigger modal -->
    <button type="button" class="btn btn-primary mt-3" data-bs-toggle="modal" data-bs-target="#imagePostModal">
        Make a Post
    </button>

    {% include "modals/imagePostModal.html" %}


    {% for image_post in images %}
        <div class="col-md-8">
            
            <div class="card imagePostCard mt-3" style="width: 45rem;">
                <div class="header">
                    <img src="{{image_post.posted_by.profile_pic.url}}" class="m-3" height="40"  width="40"  style="border-radius: 50%;" alt="...">
                    {% if current_user == request.user %}
                        <a href="{% url 'profile' image_post.posted_by %}"><h6>{{image_post.posted_by}}</h6></a>
                    {% else %}
                        <a href="{% url 'userProfile' image_post.posted_by %}"><h6>{{image_post.posted_by}}</h6></a>
                    {% endif %}
                </div>
                    
            
                <a href="{% url 'comment' image_post.id%}"><img src="{{image_post.image.url}}" style="max-height: 25rem;" class="card-img-top" alt="...">
                <div class="card-body">
                    <div class="post-icons" id="post-icons">
                        <a><img src="{% static 'images/likee.png' %}" id="like" alt="" onClick="return dislike();"  width="47"></a>
                        <a><img src="{% static 'images/like.jpg' %}" id="dislike" alt="" onClick="return like();"  width="43"></a>
                        <a href="{% url 'comment' image_post.id%}"><img src="{% static 'images/commentIcon.jpg' %}"  alt="" width="43"></a>
                        <a href=""><img src="{% static 'images/send.jpg' %}"  alt="" width="43"></a>

                    </div>
                    <div class="liked-by">
                        <p class="fw-light">Liked by</p>
                    </div>
                    <div class="details">      <script src="{% static 'js/main.js'%}"></script>

                        <a href="{% url 'userProfile' image_post.posted_by %}"><h6>{{image_post.posted_by}}</h6></a>
                        <p class="card-text">{{image_post.image_caption}}</p> 
                    </div>
                    
                    <div class="post-comments">
                        {% if image_post.comments.all %}
                        <p class="text-muted fw-light">view all {{image_post.comments.all.count}} comments</p>
                        {% endif %}
                        {% for comment in image_post.comments.all %}
                        <div class="details">
                            <a href="{% url 'userProfile' image_post.posted_by %}"><h6>{{comment.posted_by}}</h6></a>
                            <p class="card-text fw-light">{{comment.comment}}</p> 
                        </div>
                        
                        
                        {% empty %}
                        {% endfor %}

                        <div class="time">
                            <p class="text-muted fw-light">{{image_post.posted_on| timesince}} AGO</p>
                        </div>
                    </div>
                
                            
                </div>
                <ul class="list-group list-group-flush">
                    <li class="list-group-item">
                        <form action="" method="POST" class="d-flex">
                            {% csrf_token %}

                            <!-- <div class="form-floating"></div>
                                <input class="form-control" name="comment" placeholder="Leave a comment here" id="floatingTextarea"></input>
                                <button type="submit" class="btn">Post</button>
                            </div> -->
                        </form>
                    </li>
                </ul>

                
            </div>

        </div>

    {% empty %}
    <div class="row">
        <h6 class="text-center">There No Image Items</h6>
    </div>

    {%endfor%}


</div>

{% endblock %}